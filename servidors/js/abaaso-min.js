/**
 * Copyright (c) 2011, Jason Mulligan <jason.mulligan@avoidwork.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *     * Redistributions of source code must retain the above copyright
 *       notice, this list of conditions and the following disclaimer.
 *     * Redistributions in binary form must reproduce the above copyright
 *       notice, this list of conditions and the following disclaimer in the
 *       documentation and/or other materials provided with the distribution.
 *     * Neither the name of Jason Mulligan nor the
 *       names of its contributors may be used to endorse or promote products
 *       derived from this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED. IN NO EVENT SHALL JASON MULLIGAN BE LIABLE FOR ANY
 * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
 * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
 * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
 * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
 * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

/**
 * abaaso
 *
 * Events: init           Fires when abaaso is ready; register modules on this event
 *         ready          Fires when the DOM is available
 *         render         Fires when the window resources have loaded
 *         resize         Fires when the window resizes; parameter for listeners is abaaso.client.size
 *         afterCreate    Fires after an Element is created; parameter for listeners is the (new) Element
 *         afterDestroy   Fires after an Element is destroyed; parameter for listeners is the (removed) Element.id value
 *         beforeCreate   Fires when an Element is about to be created; parameter for listeners is the (new) Element.id value
 *         beforeDestroy  Fires when an Element is about to be destroyed; parameter for listeners is the (to be removed) Element
 *         error          Fires when an Error is caught; parameter for listeners is the logged Object (abaaso.error.log[n])
 *         hash           Fires when window.location.hash changes; parameter for listeners is the hash value
 *
 * @author Jason Mulligan <jason.mulligan@avoidwork.com>
 * @link http://abaaso.com/
 * @module abaaso
 * @version 1.7.62
 */
var $=$||null,abaaso=function(){"use strict";var a={cast:function(a,b){if(!c.safari&&typeof a!="object"||c.safari&&typeof a!="function")throw Error(i.error.expectedObject);b=b===!0;var d=[],e,f;switch(!0){case!isNaN(a.length):for(e=0,f=a.length;e<f;e++)d.push(a[e]);break;default:for(e in a)d.push(b?e:a[e])}return d},contains:function(a,b){b.indexOf(",")>-1&&(b=b.explode(","));if(b instanceof Array){var c=[],d=args.length,e=null;for(e=0;e<d;e++)c[e]=a.index(b[e]);return c}return a.index(b)},diff:function(a,b){var c=a.length>b.length?a:b,d=c===a?b:a;return c.filter(function(a){if(d.indexOf(a)===-1)return!0})},first:function(a){return a[0]},index:function(a,b){var c=a.length;while(c--)if(a[c]===b)return c;return-1},indexed:function(a){var b,c=[];for(b in a)a.hasOwnProperty(b)&&c.push(a[b]instanceof Array?a[b].indexed():a[b]);return c},intersect:function(a,b){var c=a.length>b.length?a:b,d=c===a?b:a;return c.filter(function(a){if(d.indexOf(a)>-1)return!0})},keys:function(a){var b,c=[];for(b in a)a.hasOwnProperty(b)&&isNaN(b)&&c.push(b);return c},last:function(a){return a.length>1?a[a.length-1]:a.first()},remove:function(a,b,c){if(typeof b=="string"){b=a.index(b);if(b===-1)return a}else b=b||0;var d=a.length,e=a.slice((c||b)+1||d);return a.length=b<0?d+b:b,a.push.apply(a,e),a},total:function(a){return a.indexed().length}},b={items:{},clean:function(){var a;for(a in b.items)b.expired(a)&&b.expire(a)},expire:function(a,c){c=c===!0,typeof b.items[a]!="undefined"&&(delete b.items[a],c||a.fire("expire"))},expired:function(a){var c=b.items[a];return typeof c!="undefined"&&typeof c.expires!="undefined"&&c.expires<new Date},get:function(a,c){return c=c!==!1,typeof b.items[a]=="undefined"?!1:c&&b.expired(a)?(b.expire(a),!1):b.items[a]},set:function(a,c,d){return typeof b.items[a]=="undefined"&&(b.items[a]={},b.items[a].permission=0),c==="permission"?b.items[a].permission|=d:c==="!permission"?b.items[a].permission&=~d:b.items[a][c]=d,b.items[a]}},c={android:function(){return/android/i.test(navigator.userAgent)}(),blackberry:function(){return/blackberry/i.test(navigator.userAgent)}(),chrome:function(){return/chrome/i.test(navigator.userAgent)}(),css3:function(){switch(!0){case this.mobile:case this.tablet:case this.chrome&&this.version>5:case this.firefox&&this.version>2:case this.ie&&this.version>8:case this.opera&&this.version>8:case this.safari&&this.version>4:return this.css3=!0,!0;default:return this.css3=!1,!1}},expire:0,firefox:function(){return/firefox/i.test(navigator.userAgent)}(),ie:function(){return/msie/i.test(navigator.userAgent)}(),ios:function(){return/ipad|iphone/i.test(navigator.userAgent)}(),linux:function(){return/linux|bsd|unix/i.test(navigator.userAgent)}(),mobile:function(){return/android|blackberry|ipad|iphone|meego|webos/i.test(navigator.userAgent)}(),playbook:function(){return/playbook/i.test(navigator.userAgent)}(),opera:function(){return/opera/i.test(navigator.userAgent)}(),osx:function(){return/macintosh/i.test(navigator.userAgent)}(),safari:function(){return/safari/i.test(navigator.userAgent.replace(/chrome.*/i,""))}(),tablet:function(){return/android|ipad|playbook|webos/i.test(navigator.userAgent)&&(c.size.x>=1e3||c.size.y>=1e3)},webos:function(){return/webos/i.test(navigator.userAgent)}(),windows:function(){return/windows/i.test(navigator.userAgent)}(),version:function(){var a=0;switch(!0){case this.chrome:a=navigator.userAgent.replace(/(.*chrome\/|safari.*)/gi,"");break;case this.firefox:a=navigator.userAgent.replace(/(.*firefox\/)/gi,"");break;case this.ie:a=navigator.userAgent.replace(/(.*msie|;.*)/gi,"");break;case this.opera:a=navigator.userAgent.replace(/(.*opera\/|\(.*)/gi,"");break;case this.safari:a=navigator.userAgent.replace(/(.*version\/|safari.*)/gi,"");break;default:a=navigator.appVersion}return a=isNaN(parseInt(a))?0:parseInt(a),this.version=a,a},allows:function(a,c){try{if(a.isEmpty()||c.isEmpty())throw Error(i.error.invalidArguments);if(!b.get(a,!1))return undefined;var d;switch(!0){case c.toLowerCase()==="delete":d=(a.permissions(c).bit&1)!==0;break;case c.toLowerCase()==="get":d=(a.permissions(c).bit&4)!==0;break;case/post|put/i.test(c):d=(a.permissions(c).bit&2)!==0;break;default:d=!1}return d}catch(e){return q(e,arguments,this),undefined}},bit:function(a){var b=0;return a.each(function(a){switch(a.toLowerCase()){case"get":b|=4;break;case"post":case"put":b|=2;break;case"delete":b|=1}}),b},headers:function(a,d,e){try{var f=String(a.getAllResponseHeaders()).split("\n"),g={},h={},i=null,j=new Date,k,l;f.each(function(a){a.isEmpty()||(k=a.toString(),l=k.substr(k.indexOf(":")+1,k.length).replace(/\s/,""),k=k.substr(0,k.indexOf(":")).replace(/\s/,""),g[k]=l,/allow|access-control-allow-methods/i.test(k)&&(i=l))});switch(!0){case typeof g["Cache-Control"]!="undefined"&&/no/.test(g["Cache-Control"]):case typeof g.Pragma!="undefined"&&/no/.test(g.Pragma):break;case typeof g["Cache-Control"]!="undefined"&&/\d/.test(g["Cache-Control"]):j=j.setSeconds(j.getSeconds()+parseInt(/\d{1,}/.exec(g["Cache-Control"])[0]));break;case typeof g.Expires!="undefined":j=new Date(g.Expires);break;default:j=j.setSeconds(j.getSeconds()+$.expires)}return h.expires=j,h.headers=g,h.permission=c.bit(i!==null?i.explode(","):[e]),e!=="head"&&(b.set(d,"expires",h.expires),b.set(d,"headers",h.headers),b.set(d,"permission",h.permission)),h}catch(m){return q(m,arguments,this),undefined}},permissions:function(a){var c=b.get(a,!1),d=c?c.permission:0,e={allows:[],bit:d,map:{read:4,write:2,"delete":1}};return d&1&&e.allows.push("DELETE"),d&2&&function(){e.allows.push("PUT"),e.allows.push("PUT")}(),d&4&&e.allows.push("GET"),e},jsonp:function(a,b,c,d){var e=(new String(a)).toString(),g=m.guid(),h,i,j;switch(!0){case typeof d=="undefined":case d===null:case d instanceof Object&&(d.callback===null||typeof d.callback=="undefined"):case typeof d=="string"&&d.isEmpty():h="callback";break;case d instanceof Object&&typeof d.callback!="undefined":h=d.callback;break;default:h="callback"}e=e.replace(h+"=?",""),e.on("failedGet",function(){this.un("failedGet",g).on("afterJSONP",function(a){this.un("afterJSONP",g).un("failedJSONP",g),typeof b=="function"&&b(a)},g).on("failedJSONP",function(){this.un("afterJSONP",g).un("failedJSONP",g),typeof c=="function"&&c()},g);do i=m.genId().slice(0,10);while(typeof abaaso.callback[i]!="undefined");a=a.replace(h+"=?",h+"=abaaso.callback."+i),abaaso.callback[i]=function(a){$.destroy(j),clearTimeout(abaaso.timer[i]),delete abaaso.timer[i],delete abaaso.callback[i],e.fire("afterJSONP",a)},j=f.create("script",{src:a,type:"text/javascript"},$("head")[0]),abaaso.timer[i]=setTimeout(function(){e.fire("failedJSONP")},3e4)},g);switch(!0){case d instanceof Object&&typeof d.Accept=="undefined":d.Accept="application/json";case d instanceof Object&&typeof d.Accept!="undefined":break;default:d={Accept:"application/json"}}return e.get(b,c,d)},request:function(a,d,e,f,g){try{if(/post|put/i.test(d)&&typeof g=="undefined")throw Error(i.error.invalidArguments);d=d.toLowerCase();var j=document.location,k=a.indexOf(j.protocol+"//"+j.host)!==0,l=c.ie&&k&&d==="get"?new XDomainRequest:new XMLHttpRequest,n=/post|put/i.test(d)?g:null,o=d==="get"&&g instanceof Object?g:null,r=d==="head"?!1:b.get(a),s=d.capitalize(),t=m.guid(),u,v,w;v=function(){clearTimeout(abaaso.timer[s+"-"+a]),delete abaaso.timer[s+"-"+a],a.un("received"+s,t).un("timeout"+s,t)},w=function(){a.fire("failed"+s,t).un("failed"+s,t)},d==="delete"&&a.on("afterDelete",function(){b.expire(a),a.un("afterDelete",t)},t),a.on("received"+s,v,t).on("timeout"+s,function(){v(),w()},t).on("after"+s,function(b){a.un("received"+s,t).un("timeout"+s,t).un("after"+s,t).un("failed"+s,t),typeof e=="function"&&e(b)},t).on("failed"+s,function(){v(),a.un("after"+s,t).un("failed"+s,t),typeof f=="function"&&f()},t).fire("before"+s).fire("beforeXHR");if(d!=="head"&&a.allows(d)===!1)return v(),a.fire("failed"+s),a;if(d==="get"&&Boolean(r))a.fire("afterGet",r.response);else{abaaso.timer[s+"-"+a]=setTimeout(function(){a.fire("timeout"+s)},3e4),l[k&&c.ie?"onload":"onreadystatechange"]=function(){c.response(l,a,d)};if(c.ie&&k&&c.version<=9)if(j.protocol==="http:")l.open(d.toUpperCase(),a);else return a.fire("failed"+s);else l.open(d.toUpperCase(),a,!0);if(n!==null)switch(!0){case typeof n.xml!="undefined":n=n.xml;case n instanceof Document:n=p.decode(n);case typeof n=="string"&&/<[^>]+>[^<]*]+>/.test(n):typeof l.setRequestHeader!="undefined"&&l.setRequestHeader("Content-type","application/xml");break;case n instanceof Object:typeof l.setRequestHeader!="undefined"&&l.setRequestHeader("Content-type","application/json"),n=h.encode(n);break;default:typeof l.setRequestHeader!="undefined"&&l.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=UTF-8")}if(typeof l.setRequestHeader!="undefined"){o instanceof Object&&(typeof o.callback!="undefined"&&delete o.callback,typeof o.withCredentials!="undefined"&&delete o.withCredentials);if(o!==null)for(u in o)l.setRequestHeader(u,o[u]);typeof r=="object"&&typeof r.headers.ETag!="undefined"&&l.setRequestHeader("ETag",r.headers.ETag)}typeof l.withCredentials=="boolean"&&g instanceof Object&&typeof g.withCredentials=="boolean"&&(l.withCredentials=g.withCredentials),l.send(n)}return a}catch(x){return q(x,arguments,this),undefined}},response:function(a,d,e){try{var f=e.toLowerCase().capitalize(),g=document.location;switch(!0){case a.readyState===2:d.fire("received"+f);break;case a.readyState===4:switch(a.status){case 200:case 204:case 205:case 301:var j=null,k=abaaso.state,l=c.headers(a,d,e),m,n,o;d.fire("afterXHR");if(e==="head")return b.expire(d.fire("afterHead",l.headers),!0),d;if(e!=="delete"&&/200|301/.test(a.status)){n=typeof l.headers["Content-Type"]!="undefined"?l.headers["Content-Type"]:"";switch(!0){case(/json|plain/.test(n)||n.isEmpty())&&Boolean(o=h.decode(/[\{\[].*[\}\]]/.exec(a.responseText))):m=o;break;case/xml/.test(n)&&String(a.responseText).isEmpty()&&a.responseXML!==null:m=p.decode(typeof a.responseXML.xml!="undefined"?a.responseXML.xml:a.responseXML);break;case/<[^>]+>[^<]*]+>/.test(a.responseText):m=p.decode(a.responseText);break;default:m=a.responseText}if(typeof m=="undefined")throw Error(i.error.serverError);b.set(d,"response",l.response=m)}k.header!==null&&Boolean(j=l.headers[k.header])&&k.current!==j&&(typeof k.change=="function"?k.change(j):k.current=j);switch(a.status){case 200:d.fire("after"+f,l.response);break;case 205:d.fire("reset");break;case 301:d.fire("moved",l.response)}break;case 401:throw Error(i.error.serverUnauthorized);case 403:throw Error(i.error.serverForbidden);case 405:throw b.set(d,"!permission",c.bit(e)),Error(i.error.serverInvalidMethod);case 0:d.fire("failed"+f);break;default:throw Error(i.error.serverError)}break;case c.ie&&d.indexOf(g.protocol+"//"+g.host)!==0&&f==="Get":var m,o;switch(!0){case Boolean(o=h.decode(/[\{\[].*[\}\]]/.exec(a.responseText))):m=o;break;case/<[^>]+>[^<]*]+>/.test(a.responseText):m=p.decode(a.responseText);break;default:m=a.responseText}b.set(d,"permission",c.bit(["get"])),b.set(d,"response",m),d.fire("afterGet",m)}}catch(r){q(r,arguments,this,!0),d.fire("failed"+f)}return d},size:function(){var a=document.compatMode==="CSS1Compat"&&!c.opera?document.documentElement.clientWidth:document.body.clientWidth,b=document.compatMode==="CSS1Compat"&&!c.opera?document.documentElement.clientHeight:document.body.clientHeight;return{x:a,y:b}}},d={expire:function(a){return typeof this.get(a)!="undefined"&&this.set(a,"","-1s"),a},get:function(a){return this.list()[a]},list:function(){var a={},b,c;return typeof document.cookie!="undefined"&&!document.cookie.isEmpty()&&(c=document.cookie.split(";"),c.each(function(c){b=c.split("="),a[decodeURIComponent(b[0].toString().trim())]=decodeURIComponent(b[1].toString().trim())})),a},set:function(a,b,c){c=c.toString()||"";var d="",e=null,f=null,g=["d","h","m","s"],h=g.length;if(!c.isEmpty()){while(h--)if((new RegExp(g[h])).test(c)){f=g[h],e=parseInt(c);break}if(isNaN(e))throw Error(i.error.invalidArguments);d=new Date;switch(f){case"d":d.setDate(d.getDate()+e);break;case"h":d.setHours(d.getHours()+e);break;case"m":d.setMinutes(d.getMinutes()+e);break;case"s":d.setSeconds(d.getSeconds()+e)}}return d.isEmpty()||(d="; expires="+d.toUTCString()),document.cookie=a.toString().trim()+"="+b+d+"; path=/",this.get(a)}},e={methods:{batch:function(a,b,c){try{a=a.toString().toLowerCase()||undefined,c=c===!0;if(!/^(set|del)$/.test(a)||typeof b!="object")throw Error(i.error.invalidArguments);var d=this.parentNode,e,f,g;d.fire("beforeDataBatch");if(b instanceof Array)for(e=0,f=b.length;e<f;e++)a==="set"?(this.key!==null&&typeof b[e][this.key]!="undefined"?(g=b[e][this.key],delete b[e][this.key]):g=e.toString(),this.set(g,b[e],c)):this.del(b[e],!1,c);else for(e in b)a==="set"?(this.key!==null&&typeof b[e][this.key]!="undefined"?(g=b[e][this.key],delete b[e][this.key]):g=e.toString(),this.set(g,b[e],c)):this.del(b[e],!1,c);return a==="del"&&this.reindex(),d.fire("afterDataBatch"),this}catch(h){return q(h,arguments,this),undefined}},clear:function(){var a=this.parentNode;return a.fire("beforeDataClear"),this.callback=null,this.credentials=null,this.key=null,this.keys={},this.records=[],this.source=null,this.total=0,this.views={},this.uri=null,this._uri=null,a.fire("afterDataClear"),this},del:function(a,b,c){if(typeof a=="undefined"||typeof a!="number"&&typeof a!="string")throw Error(i.error.invalidArguments);b=b!==!1,c=c===!0;var d=this.parentNode,e={},f=new RegExp("true|undefined"),g,h,j;if(typeof a=="string"){g=a,a=this.keys[g];if(typeof g=="undefined")throw Error(i.error.invalidArguments);a=a.index}else{g=this.records[a];if(typeof g=="undefined")throw Error(i.error.invalidArguments);g=g.key}h={key:g,record:a,reindex:b},j=this.uri+"/"+g,e.uri=j.allows("delete"),e.data=this.uri.allows("delete"),d.fire("beforeDataDelete",h);switch(!0){case c:case this.uri===null:d.fire("syncDataDelete",h);break;case f.test(e.data)&&f.test(e.uri):j.del(function(){d.fire("syncDataDelete",h)},function(){d.fire("failedDataDelete",h)});break;default:d.fire("failedDataDelete",h)}return this},find:function(a,b){try{if(typeof a=="undefined")throw Error(i.error.invalidArguments);var c=[],d=typeof a=="string"?a.explode(","):a,e=[],f,g=d.length,h=this.parentNode,j={},k,l,m,n,o,p,r,s;h.fire("beforeDataFind"),n=this.records.first();switch(!0){case typeof b=="string":c=b.explode(","),r=c.length;while(r--)if(!n.data.hasOwnProperty(c[r]))throw Error(i.error.invalidArguments);break;default:for(r in n.data)c.push(r)}f=c.length,s=this.total;for(r=0;r<s;r++)for(k=0;k<f;k++)for(l=0;l<g;l++)m=c[k],p=d[l],n=new RegExp(p,"gi"),o=this.records[r].data[m],!j[this.records[r].key]&&n.test(o)&&(j[this.records[r].key]=r,e.push(this.records[r]));return h.fire("afterDataFind",j),e}catch(t){return q(t,arguments,this),undefined}},get:function(a){var b=[],c=this.parentNode,d,e,f;c.fire("beforeDataGet");switch(!0){case typeof a=="undefined"||String(a).length===0:b=this.records;break;case typeof a=="string"&&typeof this.keys[a]!="undefined":b=this.records[this.keys[a].index];break;case typeof a=="number":b=this.records[a];break;case a instanceof Array:if(!!isNaN(a[0])||!!isNaN(a[1]))throw Error(i.error.invalidArguments);e=a[0]-1,f=a[1]-1;for(d=e;d<f;d++)typeof this.records[d]!="undefined"&&b.push(this.records[d]);break;default:b=undefined}return c.fire("afterDataGet",b),b},reindex:function(){var a=this.total,b=this.parentNode,c;b.fire("beforeDataReindex"),this.views={};for(c=0;c<a;c++)this.records[c].key.isNumber()&&(delete this.keys[this.records[c].key],this.keys[c.toString()]={},this.records[c].key=c.toString()),this.keys[this.records[c].key].index=c;return b.fire("afterDataReindex"),this},set:function(a,b,c){a=a===null?undefined:a.toString(),c=c===!0;switch(!0){case(typeof a=="undefined"||a.isEmpty())&&this.uri===null:case typeof b=="undefined":case b instanceof Array:case b instanceof Number:case b instanceof String:case typeof b!="object":throw Error(i.error.invalidArguments)}var d=typeof this.keys[a]=="undefined"&&typeof this.records[a]=="undefined"?undefined:this.get(a),e=this.parentNode,f=typeof a=="undefined"?"post":"put",g={data:b,key:a,record:d},h=this.uri+"/"+a,j={},k=new RegExp("true|undefined");j.uri=h.allows(f),j.data=this.uri.allows(f),e.fire("beforeDataSet");switch(!0){case c:case this.uri===null:e.fire("syncDataSet",g);break;case k.test(j.data)&&k.test(j.uri):h[f](function(a){g.result=a,e.fire("syncDataSet",g)},function(){e.fire("failedDataSet")},b);break;default:e.fire("failedDataSet",g)}return this},sort:function(a,b){try{if(typeof a=="undefined"||String(a).isEmpty())throw Error(i.error.invalidArguments);b=b===!0;var c=this.parentNode,d=a.toCamelCase().replace(/Asc$/,""),e=[],f=[],g,h,j,k;if(!b&&this.views[d]instanceof Array)return this.views[d];if(this.total===0)return this.records;h=new RegExp("\\s+desc","i"),g=a.replace(/\s.*$/,"");if(!this.records[0].data.hasOwnProperty(g))throw Error(i.error.invalidArguments);return c.fire("beforeDataSort"),this.records.each(function(a){j=String(a.data[g]).trim()+":::"+a.key,e.push(j)}),e.sort(),h.test(a)&&e.reverse(),g=new RegExp(":::(.*)$"),e.each(function(a){k=c.data.keys[g.exec(a)[1]].index,f.push(c.data.records[k])}),this.views[d]=f,c.fire("afterDataSort",d),f}catch(l){return q(l,arguments,this),undefined}},sync:function(){try{if(this.uri===null||this.uri.isEmpty())throw Error(i.error.invalidArguments);var a=this,b=a.parentNode,c=m.guid(),d,e;return d=function(c){try{if(typeof c!="object")throw Error(i.error.expectedObject);var d,e=[];a.source!==null&&typeof c[a.source]!="undefined"&&(c=c[a.source]);if(c instanceof Array)e=c;else for(d in c)if(c[d]instanceof Array){e=e.concat(c[d]);break}a.batch("set",e,!0),b.fire("afterDataSync",c)}catch(f){q(f,arguments,this),b.fire("failedDataSync")}},e=function(){b.fire("failedDataSync")},b.fire("beforeDataSync"),this.uri.jsonp(d,e,{callback:this.callback,withCredentials:this.credentials}),this}catch(f){return q(f,arguments,this),this}}},register:function(d,e){if(d instanceof Array)return d.each(function(a){e.register(a,e)});var f,g;f=function(){return this._uri},g=function(a){try{if(a!==null&&a.isEmpty())throw Error(i.error.invalidArguments);if(this._uri===a)return;this.uri!==null&&(this.uri.un("expire","dataSync"),b.expire(this.uri,!0)),this._uri=a,a!==null&&(this.uri.on("expire",function(){var a=m.guid();this.sync(),this.parentNode.on("afterDataSync",function(){this.parentNode.un("afterDataSync",a),this.reindex()},a,this)},"dataSync",this),b.expire(a,!0),this.sync())}catch(c){return q(c,arguments,this),undefined}},d=m.object(d),$.genId(d);switch(!0){case typeof d.fire=="undefined":d.fire=function(a,b){return $.fire.call(this,a,b)};case typeof d.listeners=="undefined":d.listeners=function(a){return $.listeners.call(this,a)};case typeof d.on=="undefined":d.on=function(a,b,c,d,e){return $.on.call(this,a,b,c,d,e)};case typeof d.un=="undefined":d.un=function(a,b){return $.un.call(this,a,b)}}d.fire("beforeDataStore"),d.data=$.extend(this.methods),d.data.parentNode=d,d.data.clear(),d.on("syncDataDelete",function(a){var b=this.get(a.record);return this.records.remove(a.record),delete this.keys[a.key],this.total--,this.views={},a.reindex&&this.reindex(),this.parentNode.fire("afterDataDelete",b),this.parentNode},m.guid(),d.data),d.on("syncDataSet",function(b){var c;if(typeof b.record=="undefined"){var d=this.total;this.total++;if(typeof b.key=="undefined"){if(typeof b.result=="undefined")throw this.fire("failedDataSet"),Error(i.error.expectedObject);b.key=this.key===null?a.cast(b.result).first():b.result[this.key],b.key=b.key.toString()}typeof b.data[b.key]!="undefined"&&(b.key=b.data[b.key]),this.keys[b.key]={},this.keys[b.key].index=d,this.records[d]={},c=this.records[d],c.data=$.clone(b.data),c.key=b.key,this.key!==null&&this.records[d].data.hasOwnProperty(this.key)&&delete this.records[d].data[this.key]}else b.record.data=$.clone(b.data),c=b.record;this.views={},this.parentNode.fire("afterDataSet",c)},m.guid(),d.data);switch(!0){case(!c.ie||c.version>8)&&typeof Object.defineProperty=="function":Object.defineProperty(d.data,"uri",{get:f,set:g});break;case typeof d.data.__defineGetter__=="function":d.data.__defineGetter__("uri",f),d.data.__defineSetter__("uri",g);break;default:d.data.uri=null,d.data.setUri=function(a){d.data.uri=a,g.call(d.data,a)}}return typeof e=="object"&&d.data.batch("set",e),d.fire("afterDataStore"),d}},f={klass:function(a,b,d){try{if(a instanceof Array)return a.each(function(a){f.klass(a,b,d)});a=m.object(a),d=d!==!1;if(a instanceof Element!=!0||String(b).isEmpty())throw Error(i.error.invalidArguments);a.fire("beforeClassChange");var e=a.className.split(" "),g=e.length,h;switch(!0){case d:e.index(b)<0&&e.push(b);break;case!d:b==="*"?e=[]:e.remove(b)}return e=e.join(" "),c.ie&&c.version<9?a.className=e:a.setAttribute("class",e),a.fire("afterClassChange"),a}catch(j){return q(j,arguments,this),undefined}},clear:function(a){try{if(a instanceof Array)return a.each(function(a){f.clear(a)});a=m.object(a);if(a instanceof Element!=!0)throw Error(i.error.invalidArguments);a.fire("beforeClear");switch(!0){case typeof a.reset=="function":a.reset();break;case typeof a.value!="undefined":a.update({innerHTML:"",value:""});break;default:a.update({innerHTML:""})}return a.fire("afterClear"),a}catch(b){return q(b,arguments,this),undefined}},create:function(a,b,c,d){try{if(typeof a=="undefined"||String(a).isEmpty())throw Error(i.error.invalidArguments);var e,f;switch(!0){case typeof c!="undefined":c=m.object(c);break;case typeof b!="undefined"&&(typeof b=="string"||typeof b.childNodes!="undefined"):c=m.object(b);break;default:c=document.body}if(typeof c=="undefined")throw Error(i.error.invalidArguments);f=typeof b!="undefined"&&typeof b!="string"&&typeof b.childNodes=="undefined"&&typeof b.id!="undefined"&&typeof $("#"+b.id)=="undefined"?b.id:m.genId(),typeof b!="undefined"&&typeof b.id!="undefined"&&delete b.id,$.fire("beforeCreate",f),f.fire("beforeCreate"),e=document.createElement(a),e.id=f,typeof b=="object"&&typeof b.childNodes=="undefined"&&e.update(b);switch(!0){case typeof d=="undefined":c.appendChild(e);break;case typeof d.after!="undefined":c.insertBefore(e,d.after.nextSibling);break;case typeof d.before!="undefined":c.insertBefore(e,d.before);break;default:c.appendChild(e)}return e.fire("afterCreate"),$.fire("afterCreate",e),e}catch(g){return q(g,arguments,this),undefined}},css:function(a){var b,c;return b=$.create("style",{type:"text/css"},$("head")[0]),b.styleSheet?b.styleSheet.cssText=a:(c=document.createTextNode(a),b.appendChild(c)),b},destroy:function(a){try{if(a instanceof Array){var b=isNaN(a.length)?a.total():a.length;while(b--)this.destroy(a[b]);return a}a=m.object(a);if(a instanceof Element!=!0)throw Error(i.error.invalidArguments);$.fire("beforeDestroy",a),a.fire("beforeDestroy"),l.remove(a.id),a.parentNode.removeChild(a),a.fire("afterDestroy"),$.fire("afterDestroy",a.id)}catch(c){q(c,arguments,this)}return undefined},disable:function(a){try{if(a instanceof Array){var b=isNaN(a.length)?a.total():a.length;while(b--)this.disable(a[b]);return a}a=m.object(a);if(a instanceof Element!=!0)throw Error(i.error.invalidArguments);return typeof a.disabled=="boolean"&&!a.disabled&&(a.fire("beforeDisable"),a.disabled=!0,a.fire("afterDisable")),a}catch(c){return q(c,arguments,this),undefined}},enable:function(a){try{if(a instanceof Array){var b=isNaN(a.length)?a.total():a.length;while(b--)this.enable(a[b]);return a}a=m.object(a);if(a instanceof Element!=!0)throw Error(i.error.invalidArguments);return typeof a.disabled=="boolean"&&a.disabled&&(a.fire("beforeEnable"),a.disabled=!1,a.fire("afterEnable")),a}catch(c){return q(c,arguments,this),undefined}},hide:function(a){try{if(a instanceof Array)return a.each(function(a){f.hide(a)});a=m.object(a);if(a instanceof Element!=!0)throw Error(i.error.invalidArguments);a.fire("beforeHide");switch(!0){case typeof a.hidden=="boolean":a.hidden=!0;break;default:a["data-display"]=a.style.display,a.style.display="none"}return a.fire("afterHide"),a}catch(b){return q(b,arguments,this),undefined}},hidden:function(a){try{a=m.object(a);if(a instanceof Element!=!0)throw Error(i.error.invalidArguments);return a.style.display==="none"||typeof a.hidden=="boolean"&&a.hidden}catch(b){return q(b,arguments,this),undefined}},position:function(a){try{a=m.object(a);if(a instanceof Element!=!0)throw Error(i.error.invalidArguments);var b=top=null;if(a.offsetParent){b=a.offsetLeft,top=a.offsetTop;while(a=a.offsetParent)b+=a.offsetLeft,top+=a.offsetTop}return[b,top]}catch(c){return q(c,arguments,this),undefined}},show:function(a){try{if(a instanceof Array)return a.each(function(a){f.show(a)});a=m.object(a);if(a instanceof Element!=!0)throw Error(i.error.invalidArguments);a.fire("beforeShow");switch(!0){case typeof a.hidden=="boolean":a.hidden=!1;break;default:a.style.display=typeof a["data-display"]!="undefined"&&!a["data-display"].isEmpty()?a["data-display"]:"inherit"}return a.fire("afterShow"),a}catch(b){return q(b,arguments,this),undefined}},size:function(a){try{if(a instanceof Array){var b=[];return a.each(function(a){b.push(f.size(a))}),b}a=m.object(a);if(a instanceof Element!=!0)throw Error(i.error.invalidArguments);var c=function(a){return isNaN(parseInt(a))?0:parseInt(a)},d=a.offsetHeight+c(a.style.paddingTop)+c(a.style.paddingBottom)+c(a.style.borderTop)+c(a.style.borderBottom),e=a.offsetWidth+c(a.style.paddingLeft)+c(a.style.paddingRight)+c(a.style.borderLeft)+c(a.style.borderRight);return{x:d,y:e}}catch(g){return q(g,arguments,this),undefined}},update:function(a,b){try{a=m.object(a),b=b||{};if(a instanceof Array)return a.each(function(a){f.update(a,b)});if(a instanceof Element!=!0)throw Error(i.error.invalidArguments);a.fire("beforeUpdate");var c;for(c in b){if(!b.hasOwnProperty(c))continue;switch(c){case"innerHTML":case"type":case"src":a[c]=b[c];break;case"class":b[c].isEmpty()?a.removeClass("*"):a.addClass(b[c]);break;case"id":var d=l.listeners;typeof d[a.id]!="undefined"&&(d[b[c]]=$.clone(d[a.id]),delete d[a.id]);default:a.setAttribute(c,b[c])}}return a.fire("afterUpdate"),a}catch(e){return q(e,arguments,this),undefined}}},g={diff:function(a){try{if(typeof a!="number"||typeof this!="number")throw Error(i.error.expectedNumber);return Math.abs(this-a)}catch(b){return q(b,arguments,this),undefined}},format:function(a,b,c){try{if(typeof a!="number")throw Error(i.error.expectedNumber);a=a.toString(),b=b||",",c=c||3;var d=a.indexOf(".")>-1?"."+a.replace(/.*\./,""):"",e=a.replace(/\..*/,"").split("").reverse(),f=Math.floor(e.length/c),g=1,h,j;for(j=0;j<f;j++)h=g===1?c:c*g+(g===2?1:g-1),e.splice(h,0,b),g++;return e=e.reverse().join(""),e.charAt(0)===b&&(e=e.substring(1)),e+d}catch(k){return q(k,arguments,this),undefined}},even:function(a){return a%2===0},odd:function(a){return a%2!==0}},h={decode:function(a){try{return JSON.parse(a)}catch(b){return q(b,arguments,this),undefined}},encode:function(a){try{return JSON.stringify(a)}catch(b){return q(b,arguments,this),undefined}}},i={common:{back:"Back",cancel:"Cancel",clear:"Clear",close:"Close",cont:"Continue",del:"Delete",edit:"Edit",find:"Find",gen:"Generate",go:"Go",loading:"Loading",next:"Next",login:"Login",ran:"Random",save:"Save",search:"Search",submit:"Submit"},error:{databaseNotOpen:"Failed to open the Database, possibly exceeded Domain quota",databaseNotSupported:"Client does not support local database storage",databaseWarnInjection:"Possible SQL injection in database transaction, use the &#63; placeholder",elementNotCreated:"Could not create the Element",elementNotFound:"Could not find the Element",expectedArray:"Expected an Array",expectedArrayObject:"Expected an Array or Object",expectedBoolean:"Expected a Boolean value",expectedNumber:"Expected a Number",expectedObject:"Expected an Object",invalidArguments:"One or more arguments is invalid",invalidDate:"Invalid Date",invalidFields:"The following required fields are invalid: ",propertyNotFound:"Could not find the requested property",serverError:"Server error has occurred",serverForbidden:"Forbidden to access URI",serverInvalidMethod:"Method not allowed",serverUnauthorized:"Authorization required to access URI"},months:{0:"January",1:"February",2:"March",3:"April",4:"May",5:"June",6:"July",7:"August",8:"September",9:"October",10:"November",11:"December"}},j={clear:function(){return $.un(window,"message")},send:function(a,b){try{return a.postMessage(b,"*"),a}catch(c){return q(c,arguments,this),undefined}},recv:function(a){return $.on(window,"message",a)}},k={enabled:!1,log:!1,diff:{x:null,y:null},pos:{x:null,y:null},prev:{x:null,y:null},track:function(a){var b=abaaso.mouse;switch(!0){case typeof a=="object":var d=a.pageX?a.pageX:(c.ie&&c.version<9?document.documentElement.scrollLeft:document.body.scrollLeft)+n.clientX,e=a.pageY?a.pageY:(c.ie&&c.version<9?document.documentElement.scrollTop:document.body.scrollTop)+n.clientY,f=!1;b.pos.x!==d&&(f=!0),$.mouse.prev.x=b.prev.x=Number(b.pos.x),$.mouse.pos.x=b.pos.x=d,$.mouse.diff.x=b.diff.x=b.pos.x-b.prev.x,b.pos.y!==e&&(f=!0),$.mouse.prev.y=b.prev.y=Number(b.pos.y),$.mouse.pos.y=b.pos.y=e,$.mouse.diff.y=b.diff.y=b.pos.y-b.prev.y,f&&b.log&&m.log(b.pos.x+" ["+b.diff.x+"], "+b.pos.y+" ["+b.diff.y+"]");break;case typeof a=="boolean":a?l.add(document,"mousemove",abaaso.mouse.track):l.remove(document,"mousemove"),$.mouse.enabled=b.enabled=a}return b}},l={listeners:{},log:!1,add:function(a,b,c,d,e,f){try{a=m.object(a),e=e||abaaso;if(a instanceof Array)return a.each(function(a){l.add(a,b,c,d,e,f)});if(typeof d=="undefined"||!/\w/.test(d))d=m.guid();var g=null,h=l.listeners,j=this.id(a),k,n;if(typeof j=="undefined"||typeof b=="undefined"||typeof c!="function")throw Error(i.error.invalidArguments);switch(!0){case typeof h[j]=="undefined":h[j]={};case typeof h[j][b]=="undefined":h[j][b]={};case typeof h[j][b].active=="undefined":h[j][b].active={};case typeof h[j][b].standby=="undefined":h[j][b].standby={}}n={fn:c,scope:e};if(typeof f=="undefined"){h[j][b].active[d]=n;switch(!0){case/body|document|window/i.test(j):g=a;break;default:g=!/\//g.test(j)&&j!=="abaaso"?$("#"+j):null}k=function(c){c||(c=window.event),typeof c.cancelBubble!="undefined"&&(c.cancelBubble=!0),typeof c.preventDefault=="function"&&c.preventDefault(),typeof c.stopPropagation=="function"&&c.stopPropagation(),typeof g.fire=="function"?g.fire(b,c):l.fire(a,b,c)},g!==null&&b.toLowerCase()!=="afterjsonp"&&typeof g!="undefined"&&(typeof g.addEventListener=="function"?g.addEventListener(b,k,!1):g.attachEvent("on"+b,k))}else typeof h[j][b].standby[f]=="undefined"&&(h[j][b].standby[f]={}),h[j][b].standby[f][d]=n;return a}catch(o){return q(o,arguments,this),undefined}},id:function(a){var b;switch(!0){case a===abaaso:b="abaaso";break;case a===document:b="document";break;case a===document.body:b="body";break;case a===window:b="window";break;default:b=typeof a.id!="undefined"?a.id:typeof a.toString=="function"?a.toString():a}return b},fire:function(a,b,c){try{a=m.object(a);if(a instanceof Array)return a.each(function(d){l.fire(a[d],b,c)});var d=this.id(a),e,f,g;if(typeof d=="undefined"||String(d).isEmpty()||typeof a=="undefined"||typeof b=="undefined")throw Error(i.error.invalidArguments);abaaso.observer.log&&m.log("["+(new Date).toLocaleTimeString()+"] "+d+"."+b),g=this.list(a,b).active;for(f in g)g[f].fn.call(g[f].scope,c);return abaaso.observer.fired++,$.observer.fired=abaaso.observer.fired,a}catch(h){return q(h,arguments,this),undefined}},list:function(a,b){a=m.object(a);var c=this.listeners,d=this.id(a),e;switch(!0){case typeof c[d]=="undefined"&&typeof b=="undefined":e={};break;case typeof c[d]!="undefined"&&(typeof b=="undefined"||String(b).isEmpty()):e=c[d];break;case typeof c[d]!="undefined"&&typeof c[d][b]!="undefined":e=c[d][b];break;default:e={active:{},standby:{}}}return e},remove:function(a,b,c){a=m.object(a);if(a instanceof Array)return a.each(function(a){l.remove(a,b,c)});var d=null,e=l.listeners,f=this.id(a),g;switch(!0){case typeof f=="undefined":case typeof b=="undefined":case typeof e[f]=="undefined":case typeof e[f][b]=="undefined":return a}if(typeof c=="undefined"){delete e[f][b];switch(!0){case/body|document|window/i.test(f):d=a;break;default:d=!/\//g.test(f)&&f!=="abaaso"?$("#"+f):null}g=function(c){c||(c=window.event),typeof c.cancelBubble!="undefined"&&(c.cancelBubble=!0),typeof c.preventDefault=="function"&&c.preventDefault(),typeof c.stopPropagation=="function"&&c.stopPropagation(),typeof d.fire=="function"?d.fire(b):l.fire(a,b,c)},d!==null&&b.toLowerCase()!=="afterjsonp"&&typeof d!="undefined"&&(typeof d.removeEventListener=="function"?d.removeEventListener(b,g,!1):d.detachEvent("on"+b,g))}else typeof e[f][b].active[c]!="undefined"&&delete e[f][b].active[c];return a},state:function(a){var b=this.listeners,c,d;for(c in b)for(d in b[c])b[c][d].standby[$.state.previous]=b[c][d].active,b[c][d].active=typeof b[c][d].standby[a]!="undefined"?b[c][d].standby[a]:{},typeof b[c][d].standby[a]!="undefined"&&delete b[c][d].standby[a];return $.fire(a),abaaso}},m={$:function(b,d){b=b.trim(),d=d===!0,b.indexOf(",")>-1&&(b=b.explode(","));if(b instanceof Array){var e=[];return b.each(function(a){e.push($(a,d))}),e}var f,g;switch(!0){case/\s|>/.test(b):g=b.trim().split(" ").filter(function(a){if(a.trim()!==""&&a!==">")return!0}),g=g[g.length-1],f=document[g.indexOf("#")>-1&&g.indexOf(":")===-1?"querySelector":"querySelectorAll"](b);break;case b.indexOf("#")===0&&b.indexOf(":")===-1:f=isNaN(b.slice(1))?document.querySelector(b):document.getElementById(b.substring(1));break;case b.indexOf("#")>-1&&b.indexOf(":")===-1:f=document.querySelector(b);break;default:f=document.querySelectorAll(b)}return f instanceof NodeList&&!d&&(f=!c.ie||c.version>8?Array.prototype.slice.call(f):a.cast(f)),f===null&&(f=undefined),f},alias:function(a,b){var c;for(c in b)(function(){var d=c;if(b.hasOwnProperty(d))switch(!0){case typeof b[d]=="function":a[d]=function(){return b[d].apply(this,arguments)};break;case!b[d]instanceof Array&&b[d]instanceof Object:typeof a[d]=="undefined"&&(a[d]={}),function(){abaaso.alias(a[d],b[d])}();break;case/boolean|function|number|object|string/.test(typeof b[d]):case b[d]===null:a[d]=b[d]}})();return a},clone:function(a){try{if(typeof a!="object")throw Error(i.error.expectedObject);var b=h.decode(h.encode(a));return a.hasOwnProperty("constructor")&&(b.constructor=a.constructor),a.hasOwnProperty("prototype")&&(b.prototype=a.prototype),b}catch(c){return q(c,arguments,this),undefined}},define:function(a,b,c){a=a.split("."),c=c||this,c===$&&(c=abaaso);var d=null,e=a.length,f=c;for(d=0;d<e;d++)typeof f[a[d]]=="undefined"?f[a[d]]=d+1<e?{}:typeof b!="undefined"?b:null:function(){d+1>=e&&(f[a[d]]=typeof b!="undefined"?b:null)}(),f=f[a[d]];return c},defer:function(a,b){var c=m.guid(),d=function(){delete abaaso.timer[c],a()};return abaaso.timer[c]=setTimeout(d,b),undefined},domId:function(a){return"a"+a.replace(/-/g,"").slice(1)},error:function(a,b,c,d){if(typeof a=="undefined")return;d=d===!0;var e={arguments:b,message:typeof a.message!="undefined"?a.message:a,number:typeof a.number!="undefined"?a.number&65535:undefined,scope:c,timestamp:(new Date).toUTCString(),type:typeof a.type!="undefined"?a.type:"TypeError"};return typeof console!="undefined"&&console[d?"warn":"error"](e.message),abaaso.error.log.push(e),abaaso.fire("error",e),undefined},extend:function(a,b){try{if(typeof a=="undefined")throw Error(i.error.invalidArguments);typeof b=="undefined"&&(b={});var c,d,e=function(){};e.prototype=a,d=new e;for(c in b)b.hasOwnProperty(c)&&(d[c]=b[c]);return d}catch(f){return q(f,arguments,this),undefined}},genId:function(a){switch(!0){case a instanceof Array:case a instanceof String:case typeof a=="string":case typeof a!="undefined"&&typeof a.id!="undefined"&&/\w/.test(a.id):return a}var b;do b=m.domId(m.guid());while(typeof $("#"+b)!="undefined");return typeof a=="object"?(a.id=b,a):b},guid:function(){function a(){return((1+Math.random())*65536|0).toString(16).substring(1)}return(a()+a()+"-"+a()+"-4"+a().substr(0,3)+"-"+a()+"-"+a()+a()+a()).toLowerCase()},loading:function(a){try{if(a instanceof Array)return a.each(function(a){m.loading(a)});var b=abaaso.loading;if(b.url===null)throw Error(i.error.elementNotFound);a=m.object(a);if(typeof a=="undefined")throw Error(i.error.invalidArguments);return typeof b.image=="undefined"&&(b.image=new Image,b.image.src=b.url),a.clear(),a.create("div",{"class":"loading"}).create("img",{alt:i.common.loading,src:b.image.src}),a}catch(c){return q(c,arguments,this),undefined}},log:function(a){try{console.log(a)}catch(b){q(b,arguments,this)}return undefined},module:function(a,b){try{if(typeof $[a]!="undefined"||typeof abaaso[a]!="undefined"||!b instanceof Object)throw Error(i.error.invalidArguments);return abaaso[a]=b,$[a]={},$.alias($[a],abaaso[a])}catch(c){return q(c,arguments,this),undefined}},object:function(a){return typeof a=="object"?a:a.toString().charAt(0)==="#"?$(a):a},proto:function(d,e){var g,h={array:{addClass:function(a){return this.each(function(b){b.addClass(a)})},contains:function(b){return a.contains(this,b)},css:function(a,b){return this.each(function(c){c.css(a,b)})},diff:function(b){return a.diff(this,b)},each:function(a){return this.forEach(a),this},first:function(){return a.first(this)},hide:function(){return this.each(function(a){a.hide()})},index:function(b){return a.index(this,b)},indexed:function(){return a.indexed(this)},intersect:function(b){return a.intersect(this,b)},keys:function(){return a.keys(this)},last:function(b){return a.last(this)},on:function(a,b,c,d,e){return $.on.call(this,a,b,c,typeof d!="undefined"?d:!0,e)},remove:function(b){return a.remove(this,b)},removeClass:function(a){return this.each(function(b){b.removeClass(a)})},show:function(){return this.each(function(a){a.show()})},text:function(a){return this.each(function(b){typeof b!="object"&&(b=m.object(b)),typeof b.text=="function"&&b.text(a)})},total:function(){return a.total(this)},update:function(a){return this.each(function(b){f.update(b,a)})},validate:function(){var a=[];return this.each(function(b){typeof b.validate=="function"&&a.push(b.validate())}),a}},element:{addClass:function(a){return this.genId(),f.klass(this,a,!0)},create:function(a,b){return this.genId(),f.create(a,b,this)},css:function(a,b){var d;return this.genId(),!c.chrome&&(d=a.indexOf("-"))&&d>-1&&(a=a.replace("-",""),a=a.slice(0,d)+a.charAt(d).toUpperCase()+a.slice(d+1,a.length)),this.style[a]=b,this},disable:function(){return f.disable(this)},enable:function(){return f.enable(this)},get:function(a,c){this.fire("beforeGet");var d=b.get(a),e=m.guid(),f=this;return d?this.text(d.response).fire("afterGet"):a.get(function(a){f.text(a).fire("afterGet")},null,c),this},hide:function(){return this.genId(),f.hide(this)},isAlphaNum:function(){return this.nodeName==="FORM"?!1:o.test({alphanum:typeof this.value!="undefined"?this.value:this.innerText}).pass},isBoolean:function(){return this.nodeName==="FORM"?!1:o.test({"boolean":typeof this.value!="undefined"?this.value:this.innerText}).pass},isDate:function(){return this.nodeName==="FORM"?!1:typeof this.value!="undefined"?this.value.isDate():this.innerText.isDate()},isDomain:function(){return this.nodeName==="FORM"?!1:typeof this.value!="undefined"?this.value.isDomain():this.innerText.isDomain()},isEmail:function(){return this.nodeName==="FORM"?!1:typeof this.value!="undefined"?this.value.isEmail():this.innerText.isEmail()},isEmpty:function(){return this.nodeName==="FORM"?!1:typeof this.value!="undefined"?this.value.isEmpty():this.innerText.isEmpty()},isIP:function(){return this.nodeName==="FORM"?!1:typeof this.value!="undefined"?this.value.isIP():this.innerText.isIP()},isInt:function(){return this.nodeName==="FORM"?!1:typeof this.value!="undefined"?this.value.isInt():this.innerText.isInt()},isNumber:function(){return this.nodeName==="FORM"?!1:typeof this.value!="undefined"?this.value.isNumber():this.innerText.isNumber()},isPhone:function(){return this.nodeName==="FORM"?!1:typeof this.value!="undefined"?this.value.isPhone():this.innerText.isPhone()},isString:function(){return this.nodeName==="FORM"?!1:typeof this.value!="undefined"?this.value.isString():this.innerText.isString()},jsonp:function(a,b,d){var e=this,f=b,g;return g=function(a){var b=e,c=a,d=f,g,h,j;try{typeof d!="undefined"?(d=d.replace(/]|'|"/g,"").replace(/\./g,"[").split("["),d.each(function(a){c=c[isNaN(a)?a:parseInt(a)];if(typeof c=="undefined")throw Error(i.error.propertyNotFound)}),j=c):j=a}catch(k){j=i.error.serverError,q(k,arguments,this)}b.text(j)},c.jsonp(a,g,function(){e.text(i.error.serverError)},d),this},loading:function(){return $.loading.create(this)},on:function(a,b,c,d,e){return this.genId(),$.on.call(this,a,b,c,d,e)},position:function(){return this.genId(),f.position(this)},removeClass:function(a){return this.genId(),f.klass(this,a,!1)},show:function(){return this.genId(),f.show(this)},size:function(){return this.genId(),f.size(this)},text:function(a){var b={};return this.genId(),typeof this.value!="undefined"&&(b.value=a),b.innerHTML=a,this.update(b)},update:function(a){return this.genId(),f.update(this,a)},validate:function(){return this.nodeName==="FORM"?o.test(this).pass:typeof this.value!="undefined"?!this.value.isEmpty():!this.innerText.isEmpty()}},number:{diff:function(a){return $.number.diff.call(this,a)},format:function(a,b){return $.number.format(this,a,b)},isEven:function(){return $.number.even(this)},isOdd:function(){return $.number.odd(this)},on:function(a,b,c,d,e){return $.on.call(this,a,b,c,d,e)}},shared:{clear:function(){return this.genId(),this instanceof String?this.constructor=new String(""):f.clear(this),this},destroy:function(){f.destroy(this)},fire:function(a,b){return this.genId(),$.fire.call(this,a,b)},genId:function(){return m.genId(this)},listeners:function(a){return this.genId(),$.listeners.call(this,a)},un:function(a,b){return this.genId(),$.un.call(this,a,b)}},string:{allows:function(a){return $.allows(this,a)},capitalize:function(){return this.charAt(0).toUpperCase()+this.slice(1)},del:function(a,b){return c.request(this,"DELETE",a,b)},explode:function(a){return this.split(new RegExp("\\s*"+a+"\\s*"))},get:function(a,b,d){return c.request(this,"GET",a,b,d)},isAlphaNum:function(){return o.test({alphanum:this}).pass},isBoolean:function(){return o.test({"boolean":this}).pass},isDate:function(){return o.test({date:this}).pass},isDomain:function(){return o.test({domain:this}).pass},isEmail:function(){return o.test({email:this}).pass},isEmpty:function(){return!o.test({notEmpty:this}).pass},isIP:function(){return o.test({ip:this}).pass},isInt:function(){return o.test({integer:this}).pass},isNumber:function(){return o.test({number:this}).pass},isPhone:function(){return o.test({phone:this}).pass},isString:function(){return o.test({string:this}).pass},jsonp:function(a,b,d){return c.jsonp(this,a,b,d)},post:function(a,b,d){return c.request(this,"POST",a,b,d)},put:function(a,b,d){return c.request(this,"PUT",a,b,d)},on:function(a,b,c,d,e){return $.on.call(this,a,b,c,d,e)},headers:function(a,b){return c.request(this,"HEAD",a,b)},permissions:function(){return $.permissions(this)},toCamelCase:function(){var a=this.toLowerCase().split(" "),b="",c,d;for(c=0,d=a.length;c<d;c++)b+=c===0?a[c]:String(a[c]).capitalize();return b},trim:function(){return this.replace(/^\s+|\s+$/g,"")}}};for(g in h[e])d.prototype[g]=h[e][g];for(g in h.shared)d.prototype[g]=h.shared[g];return d},queryString:function(a){a=a||".*";var b={},c=window.location.search.isEmpty()?null:window.location.search.replace("?",""),d;return c!==null&&(c=c.split("&"),c.each(function(a){d=a.split("=");switch(!0){case d[1].isNumber():d[1]=Number(d[1]);break;case d[1].isBoolean():d[1]=d[1]==="true"}switch(!0){case typeof b[d[0]]=="undefined":b[d[0]]=d[1];break;case!(b[d[0]]instanceof Array):b[d[0]]=[b[d[0]]];default:b[d[0]].push(d[1])}})),b},tpl:function(b,c){try{switch(!0){case typeof b!="object":case!/object|undefined/.test(typeof c)&&typeof (c=c.charAt(0)==="#"?$(c):$(c)[0])=="undefined":throw Error(i.error.invalidArguments)}typeof c=="undefined"&&(c=$("body")[0]);var d=document.createDocumentFragment(),e;switch(!0){case b instanceof Array:b.each(function(b){$.create(a.cast(b,!0)[0],d).text(a.cast(b)[0])});break;default:for(e in b)switch(!0){case typeof b[e]=="string":$.create(e,d).text(b[e]);break;case b[e]instanceof Object:$.tpl(b[e],$.create(e,d))}}return c.appendChild(d),c}catch(f){return q(f,arguments,this),undefined}}},o={pattern:{alphanum:/^[a-zA-Z0-9]*$/,"boolean":/^(0|1|true|false)?$/,domain:/^[\w\-_]+(\.[\w\-_]+)+([\w\-\.,@?^=%&amp;:\/~\+#]*[\w\-\@?^=%&amp;\/~\+#])?/,email:/^([0-9a-zA-Z]+([_.-]?[0-9a-zA-Z]+)*@[0-9a-zA-Z]+[0-9,a-z,A-Z,.,-]*(.) {1}[a-zA-Z]{2,4})+$/,ip:/^((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\.) {3}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})$/,integer:/(^-?\d\d*$)/,notEmpty:/\w{1,}/,number:/(^-?\d\d*\.\d*$)|(^-?\d\d*$)|(^-?\.\d\d*$)/,phone:/^\([1-9]\d{2}\)\s?\d{3}\-\d{4}$/,string:/\w/},test:function(a){var b=!1,c=[],d=null;if(typeof a.nodeName!="undefined"&&a.nodeName==="FORM"){var e,f,g,h,i,j,k={},l,m,c=[],n={};return a.id.isEmpty()&&a.genId(),h=$("#"+a.id+" > input").concat($("#"+a.id+" > select")),h.each(function(a){g=null,f=o.pattern[a.nodeName.toLowerCase()]?o.pattern[a.nodeName.toLowerCase()]:!a.id.isEmpty()&&o.pattern[a.id.toLowerCase()]?o.pattern[a.id.toLowerCase()]:"notEmpty";switch(!0){case/radio|checkbox/gi.test(a.type):if(a.name in n)return;i=$(a.name),l=i.length;for(j=0;j<l;j++)if(i[j].checked){g=i[j].value,n[a.name]=!0;continue}break;case/select/gi.test(a.type):g=a.options[a.selectedIndex].value;break;default:g=typeof a.value!="undefined"?a.value:a.innerText}g===null&&(g=""),k[f]=g}),m=this.test(k),m}var e;for(e in a){if(typeof e=="undefined"||typeof a[e]=="undefined"){c.push({test:e,value:a[e]}),b=!0;continue}d=a[e].charAt(0)==="#"?typeof $(a[e])!="undefined"?$(a[e]).value?$(a[e]).value:$(a[e]).innerHTML:"":a[e];switch(e){case"date":isNaN((new Date(d)).getYear())&&(c.push({test:e,value:d}),b=!0);break;case"domain":o.pattern.domain.test(d.replace(/.*\/\//,""))||(c.push({test:e,value:d}),b=!0);break;case"domainip":if(!o.pattern.domain.test(d.replace(/.*\/\//,""))||!o.pattern.ip.test(d))c.push({test:e,value:d}),b=!0;break;default:var f=typeof o.pattern[e]!="undefined"?o.pattern[e]:e;f.test(d)||(c.push({test:e,value:d}),b=!0)}}return{pass:!b,invalid:c}}},p={decode:function(a){try{if(typeof a!="string"||a.isEmpty())throw Error(i.error.invalidArguments);var b;return c.ie?(b=new ActiveXObject("Microsoft.XMLDOM"),b.async="false",b.loadXML(a)):b=(new DOMParser).parseFromString(a,"text/xml"),b}catch(d){return q(d,arguments,this),undefined}},encode:function(a,b){try{if(typeof a=="undefined")throw Error(i.error.invalidArguments);switch(!0){case a!==null&&typeof a.xml!="undefined":c=a.xml;break;case a instanceof Document:c=(new XMLSerializer).serializeToString(payload);break;default:b=b!==!1;var c=b?"<xml>":"",d=arguments[2]===!1?!1:!0,e,f;e=function(a,b){var c="<n>v</n>";return/\&|\<|\>|\"|\'|\t|\r|\n|\@|\$/g.test(b)&&(c=c.replace(/v/,"<![CDATA[v]]>")),c.replace(/n/g,a).replace(/v/,b)};switch(!0){case typeof a=="boolean":case typeof a=="number":case typeof a=="string":c+=e("item",a);break;case typeof a=="object":for(f in a)c+=$.xml.encode(a[f],typeof a[f]=="object",!1).replace(/item|xml/g,isNaN(f)?f:"item")}c+=b?"</xml>":"",d&&(c='<?xml version="1.0" encoding="UTF8"?>'+c)}return c}catch(g){return q(g,arguments,this),undefined}}},q=m.error;return{array:a,callback:{},client:{android:c.android,blackberry:c.blackberry,css3:!1,chrome:c.chrome,expire:c.expire,firefox:c.firefox,ie:c.ie,ios:c.ios,linux:c.linux,mobile:c.mobile,opera:c.opera,osx:c.osx,playbook:c.playbook,safari:c.safari,tablet:c.tablet,size:{x:0,y:0},version:0,webos:c.webos,windows:c.windows,del:function(a,b,d){return c.request(a,"DELETE",b,d)},get:function(a,b,d,e){return c.request(a,"GET",b,d,e)},headers:function(a,b,d){return c.request(a,"HEAD",b,d)},post:function(a,b,d,e){return c.request(a,"POST",b,d,e)},put:function(a,b,d,e){return c.request(a,"PUT",b,d,e)},jsonp:function(a,b,d,e){return c.jsonp(a,b,d,e)},permission:c.permission},cookie:d,data:e,el:f,json:h,label:i,loading:{create:m.loading,url:null},message:j,mouse:k,number:g,observer:{log:l.log,add:l.add,fire:l.fire,fired:0,list:l.list,remove:l.remove},state:{_current:null,header:null,previous:null},validate:o,xml:p,$:m.$,alias:m.alias,allows:c.allows,bootstrap:function(){typeof Array.prototype.filter=="undefined"&&(Array.prototype.filter=function(a){"use strict";if(this===void 0||this===null||typeof a!="function")throw Error(i.error.invalidArguments);var b=null,c=Object(this),d=c.length>>>0,e=[],f=arguments[1];val=null;for(b=0;b<d;b++)b in c&&(val=c[b],a.call(f,val,b,c)&&e.push(val));return e}),typeof Array.prototype.forEach=="undefined"&&(Array.prototype.forEach=function(a,b){"use string";if(this===null||typeof a!="function")throw Error(i.error.invalidArguments);var c,d=0,e=Object(this),f=e.length>>>0;b&&(c=b);while(d<f){var g;d in e&&(g=e[d],a.call(c,g,d,e)),d++}}),typeof Function.prototype.bind=="undefined"&&(Function.prototype.bind=function(a){"use strict";var b=this,c=Array.prototype.slice,d=c.call(arguments,1);return function(){return b.apply(a,d.concat(c.call(arguments)))}}),$=abaaso.$.bind($),abaaso.alias($,abaaso),delete $.$,delete $.bootstrap,delete $.init;switch(!0){case typeof document.addEventListener=="function":document.addEventListener("DOMContentLoaded",function(){abaaso.init()},!1);break;default:abaaso.timer.init=setInterval(function(){/loaded|complete/.test(document.readyState)&&(clearInterval(abaaso.timer.init),delete abaaso.timer.init,typeof abaaso.init=="function"&&abaaso.init())},10)}},clear:f.clear,clone:m.clone,create:f.create,css:f.css,decode:h.decode,defer:m.defer,define:m.define,del:function(a,b,d){return c.request(a,"DELETE",b,d)},destroy:f.destroy,encode:h.encode,error:m.error,expire:b.clean,expires:12e4,extend:m.extend,fire:function(){var a=typeof arguments[0]=="undefined"?undefined:arguments[0],b=typeof arguments[1]=="undefined"?undefined:arguments[1],c=this===$?abaaso:this;return l.fire.call(l,c,a,b)},genId:m.genId,get:function(a,b,d,e){return c.request(a,"GET",b,d,e)},guid:m.guid,headers:function(a,b,d){return c.request(a,"HEAD",b,d)},hidden:f.hidden,id:"abaaso",init:function(){delete abaaso.init,delete abaaso.bootstrap,$.error.log=abaaso.error.log=[],$.client.version=c.version(),$.client.css3=c.css3(),$.client.size=c.size(),$.client.tablet=c.tablet(),$.state.current=abaaso.state._current,m.proto(Array,"array"),m.proto(Element,"element"),c.ie&&c.version===8&&m.proto(HTMLDocument,"element"),m.proto(Number,"number"),m.proto(String,"string"),$.on(window,"hashchange",function(){$.fire("hash",location.hash)}),$.on(window,"resize",function(){$.client.size=abaaso.client.size=c.size(),$.fire("resize",$.client.size)});var a=function(){var a=this;$.timer.expire=setTimeout(function(){b.clean(),a.call(a)},$.expires)};a.call(a);var d,e;d=function(){return this._current},e=function(a){try{if(a===null||typeof a!="string"||this.current===a||a.isEmpty())throw Error(i.error.invalidArguments);return this.previous=this._current,this._current=a,l.state(a)}catch(b){return q(b,arguments,this),undefined}};switch(!0){case(!c.ie||c.version>8)&&typeof Object.defineProperty=="function":Object.defineProperty(abaaso.state,"current",{get:d,set:e});break;case typeof abaaso.state.__defineGetter__=="function":abaaso.state.__defineGetter__("current",d),abaaso.state.__defineSetter__("current",e);break;default:abaaso.state.current=null,abaaso.state.change=function(a){abaaso.state.current=a,e.call(abaaso.state,a)}}return $.fire("init").un("init"),$.timer.render=setInterval(function(){/loaded|complete/.test(document.readyState)&&(clearInterval($.timer.render),delete $.timer.render,$.fire("render").un("render"))},10),$.ready=abaaso.ready=!0,$.fire("ready").un("ready")},jsonp:function(a,b,d,e){return c.jsonp(a,b,d,e)},listeners:function(a){var b=this;return b===$&&(b=abaaso),l.list.call(l,b,a)},module:m.module,on:function(){var a=typeof arguments[2]=="function",b=a?arguments[0]:this,c=a?arguments[1]:arguments[0],d=a?arguments[2]:arguments[1],e=a?arguments[3]:arguments[2],f=a?arguments[4]:arguments[3],g=a?arguments[5]:arguments[4];return b===$&&(b=abaaso),typeof f=="undefined"&&(f=b),l.add.call(l,b,c,d,e,f,g)},permissions:c.permissions,position:f.position,post:function(a,b,d,e){return c.request(a,"POST",b,d,e)},put:function(a,b,d,e){return c.request(a,"PUT",b,d,e)},queryString:m.queryString,ready:!1,store:function(a,b){return e.register.call(e,a,b)},timer:{},tpl:m.tpl,un:function(){var a=typeof arguments[2]!="undefined",b=a?arguments[0]:this,c=a?arguments[1]:arguments[0],d=a?arguments[2]:arguments[1];return b===$&&(b=abaaso),l.remove.call(l,b,c,d)},update:f.update,version:"1.7.62"}}();typeof abaaso.bootstrap=="function"&&abaaso.bootstrap()